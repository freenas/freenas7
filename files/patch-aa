--- ./rpc_server/srv_samr_nt.c.orig	2008-12-19 13:57:33.000000000 +0000
+++ ./rpc_server/srv_samr_nt.c	2009-01-06 17:10:53.000000000 +0000
@@ -2709,7 +2709,7 @@
 		return NT_STATUS_INVALID_HANDLE;
 
 	status = access_check_samr_function(info->acc_granted,
-					    SA_RIGHT_DOMAIN_OPEN_ACCOUNT,
+					    SAMR_USER_ACCESS_GET_ATTRIBUTES,
 					    "_samr_QueryUserInfo");
 	if (!NT_STATUS_IS_OK(status)) {
 		return status;
